---
id: options-pricing
title: 옵션 가격결정 모델
sidebar_label: 옵션 가격결정
description: 블랙-숄즈 모델부터 이항트리, 몬테카를로, 확률적 변동성 모델까지 옵션 가격결정 이론의 완벽 해설
keywords: [블랙숄즈, 이항모델, 몬테카를로, 헤스톤모델, 풋콜패리티, 옵션가격, CRR모델, 로컬변동성, 조기행사, 미국형옵션]
---

# 옵션 가격결정 모델

옵션의 이론적 가격을 계산하는 것은 파생상품 금융의 핵심입니다. 1973년 블랙-숄즈-머튼(BSM) 모델의 발표는 금융공학의 시작을 알렸고, 이후 이항 모델, 몬테카를로 시뮬레이션, 확률적 변동성 모델 등이 발전하면서 점점 더 정교한 가격결정이 가능해졌습니다. 이 문서에서는 각 모델의 가정, 수학적 구조, 수치 예시, 한계를 체계적으로 다룹니다.

## 풋-콜 패리티 (Put-Call Parity)

모든 가격결정 모델에 앞서, 풋-콜 패리티는 유럽형 콜과 풋의 관계를 규정하는 기본 등식입니다. 모델에 의존하지 않는 무차익거래 관계입니다.

$$C - P = S - K \cdot e^{-rT}$$

여기서:
- $C$: 유럽형 콜옵션 가격
- $P$: 유럽형 풋옵션 가격
- $S$: 현재 기초자산 가격
- $K$: 행사가격
- $r$: 무위험 금리
- $T$: 잔존만기 (연 단위)

**직관적 이해:** "콜 매수 + 풋 매도"는 "주식 보유 - 채권 보유"와 동일한 손익 구조를 가집니다. 이 관계가 깨지면 차익거래가 가능합니다.

**수치 예시:**
- S = 50,000원, K = 50,000원, r = 3%, T = 0.25년
- C = 2,500원일 때, P = ?
- P = C - S + K·e^(-rT) = 2,500 - 50,000 + 50,000·e^(-0.03×0.25)
- P = 2,500 - 50,000 + 49,626 = 2,126원

:::tip 풋-콜 패리티의 실무 활용
풋-콜 패리티 위반은 시장에서 거의 발생하지 않지만, 배당, 거래비용, 미국형 옵션의 조기 행사 가능성 등으로 약간의 괴리가 나타날 수 있습니다. 마켓메이커는 이 괴리를 실시간 모니터링하여 차익거래 기회를 포착합니다. 또한 합성 포지션(Synthetic Position) 구성에 핵심적으로 사용됩니다.
:::

## 블랙-숄즈-머튼 모델 (Black-Scholes-Merton Model)

### 가정

BSM 모델은 다음의 가정 위에 구축됩니다.

1. 기초자산 가격은 기하 브라운 운동(GBM)을 따른다: $dS = \mu S dt + \sigma S dW$
2. 변동성($\sigma$)은 상수이다
3. 무위험 금리($r$)는 상수이다
4. 배당이 없다 (또는 연속 배당률로 조정)
5. 거래비용과 세금이 없다
6. 공매도가 자유롭다
7. 자산은 연속적으로 거래 가능하다
8. 옵션은 유럽형이다 (만기에만 행사 가능)

### 블랙-숄즈 공식

**유럽형 콜옵션:**

$$C = S \cdot N(d_1) - K \cdot e^{-rT} \cdot N(d_2)$$

**유럽형 풋옵션:**

$$P = K \cdot e^{-rT} \cdot N(-d_2) - S \cdot N(-d_1)$$

여기서:

$$d_1 = \frac{\ln(S/K) + (r + \sigma^2/2)T}{\sigma\sqrt{T}}$$

$$d_2 = d_1 - \sigma\sqrt{T}$$

- $N(\cdot)$: 표준정규분포의 누적분포함수(CDF)
- $\sigma$: 기초자산 수익률의 연율화 변동성

### 공식의 직관적 이해

BSM 공식의 각 항을 직관적으로 해석할 수 있습니다.

**콜옵션 $C = S \cdot N(d_1) - K \cdot e^{-rT} \cdot N(d_2)$:**
- $S \cdot N(d_1)$: 기초자산의 조건부 기대값 (옵션이 ITM일 때) × 행사 확률에 해당하는 가중치
- $K \cdot e^{-rT} \cdot N(d_2)$: 행사가격의 현재가치 × 행사 확률
- $N(d_2)$: 위험중립 측도에서 옵션이 ITM으로 만기되는 확률
- $N(d_1)$: 델타, 즉 헤지 비율

### 수치 계산 예시

**조건:**
- 기초자산 가격(S): 100
- 행사가격(K): 105
- 잔존만기(T): 0.5년
- 무위험 금리(r): 5%
- 변동성(σ): 20%

**계산 과정:**

| 단계 | 계산 | 결과 |
|---|---|---|
| $d_1$ | $\frac{\ln(100/105) + (0.05 + 0.04/2) \times 0.5}{0.20 \times \sqrt{0.5}}$ | $\frac{-0.0488 + 0.035}{0.1414}$ = -0.0976 |
| $d_2$ | $d_1 - 0.20 \times \sqrt{0.5}$ | -0.0976 - 0.1414 = -0.2390 |
| $N(d_1)$ | 표준정규분포 CDF | 0.4611 |
| $N(d_2)$ | 표준정규분포 CDF | 0.4055 |
| 콜 가격 | $100 \times 0.4611 - 105 \times e^{-0.025} \times 0.4055$ | 46.11 - 41.52 = **4.59** |
| 풋 가격 | 풋-콜 패리티 이용 | 4.59 - 100 + 105·e^(-0.025) = **7.01** |

### 배당 조정

배당이 있는 경우, 기초자산 가격에서 만기 전 배당의 현재가치를 차감하거나, 연속 배당률($q$)을 사용합니다.

**연속 배당 모델 (Merton 확장):**

$$C = S \cdot e^{-qT} \cdot N(d_1) - K \cdot e^{-rT} \cdot N(d_2)$$

$$d_1 = \frac{\ln(S/K) + (r - q + \sigma^2/2)T}{\sigma\sqrt{T}}$$

배당률 $q$는 지수옵션의 경우 구성종목의 가중평균 배당수익률, 개별 주식의 경우 예상 배당금을 기초자산 가격으로 나눈 값입니다.

## 이항 모델 (Binomial Model)

### CRR(Cox-Ross-Rubinstein) 모델

이항 모델은 옵션의 수명을 여러 개의 작은 시간 단계로 나누고, 각 단계에서 기초자산 가격이 상승 또는 하락하는 두 가지 경우만 존재한다고 가정합니다.

**매개변수 설정:**
- 시간 단계: $\Delta t = T/n$ (n은 단계 수)
- 상승 배율: $u = e^{\sigma\sqrt{\Delta t}}$
- 하락 배율: $d = e^{-\sigma\sqrt{\Delta t}} = 1/u$
- 위험중립 확률: $p = \frac{e^{r\Delta t} - d}{u - d}$

**이항트리 구축 과정:**

1단계: 기초자산 가격 트리 구축 (전진)
- 시점 0: $S$
- 시점 1: $Su$ (상승), $Sd$ (하락)
- 시점 2: $Su^2$, $Sud$, $Sd^2$
- ...

2단계: 만기 시 옵션 가치 계산
- 콜: $\max(S_T - K, 0)$
- 풋: $\max(K - S_T, 0)$

3단계: 역진법(Backward Induction)으로 현재 가치 계산
- 각 노드의 옵션 가치 = $e^{-r\Delta t}[p \cdot V_{up} + (1-p) \cdot V_{down}]$

### 수치 예시 (2단계 이항트리)

**조건:** S=100, K=100, r=5%, σ=20%, T=1년, n=2

| 매개변수 | 계산 | 값 |
|---|---|---|
| $\Delta t$ | 1/2 | 0.5 |
| $u$ | $e^{0.20\sqrt{0.5}}$ | 1.1519 |
| $d$ | $1/u$ | 0.8681 |
| $p$ | $\frac{e^{0.05 \times 0.5} - 0.8681}{1.1519 - 0.8681}$ | 0.5539 |

**기초자산 가격 트리:**

| 시점 | 가격 |
|---|---|
| t=0 | 100 |
| t=1 (상승) | 115.19 |
| t=1 (하락) | 86.81 |
| t=2 (상-상) | 132.69 |
| t=2 (상-하 = 하-상) | 100.00 |
| t=2 (하-하) | 75.36 |

**콜옵션 가치 (역진법):**

| 노드 | 계산 | 옵션 가치 |
|---|---|---|
| t=2: uu | max(132.69-100, 0) | 32.69 |
| t=2: ud | max(100-100, 0) | 0.00 |
| t=2: dd | max(75.36-100, 0) | 0.00 |
| t=1: u | e^(-0.025)[0.5539×32.69 + 0.4461×0] | 17.65 |
| t=1: d | e^(-0.025)[0.5539×0 + 0.4461×0] | 0.00 |
| t=0 | e^(-0.025)[0.5539×17.65 + 0.4461×0] | **9.53** |

:::caution 이항 모델의 단계 수
2단계 모델은 교육용으로만 사용합니다. 실무에서는 100~1000 단계 이상의 이항트리를 사용하여 BSM 가격에 수렴시킵니다. 단계 수가 증가할수록 이항 모델은 BSM 가격에 수렴합니다(짝수 단계를 사용하면 진동이 줄어듦).
:::

### 미국형 옵션의 가격결정

이항 모델의 핵심 장점은 미국형 옵션(조기 행사 가능)의 가격결정이 가능하다는 것입니다.

역진법의 각 노드에서:
$$V_{node} = \max\left(\text{내재가치},\ e^{-r\Delta t}[p \cdot V_{up} + (1-p) \cdot V_{down}]\right)$$

즉, 각 노드에서 "지금 행사하는 것"과 "계속 보유하는 것" 중 더 유리한 쪽을 선택합니다.

**조기 행사가 유리한 경우:**
- 깊은 ITM 미국형 풋: 행사하여 행사가격을 즉시 받고 무위험 금리로 투자하는 것이 유리할 수 있음
- 배당 지급 직전의 깊은 ITM 미국형 콜: 배당 수취를 위해 조기 행사
- 무배당 주식의 미국형 콜: 조기 행사가 최적이 아님 (항상 매도가 유리)

## 몬테카를로 시뮬레이션

### 기본 원리

몬테카를로 시뮬레이션은 기초자산 가격의 무작위 경로를 다수 생성하고, 각 경로에서의 옵션 페이오프를 계산한 후 평균을 구하여 옵션 가격을 추정합니다.

**단계:**

1. 기하 브라운 운동으로 가격 경로 생성:
$$S_{t+\Delta t} = S_t \cdot \exp\left[\left(r - \frac{\sigma^2}{2}\right)\Delta t + \sigma\sqrt{\Delta t} \cdot Z\right]$$
   여기서 $Z \sim N(0,1)$

2. 각 경로의 만기 시 페이오프 계산

3. 모든 경로의 페이오프 평균을 현재가치로 할인:
$$C \approx e^{-rT} \cdot \frac{1}{N}\sum_{i=1}^{N}\max(S_T^{(i)} - K, 0)$$

### 분산 감소 기법

몬테카를로 시뮬레이션의 정확도는 $\frac{1}{\sqrt{N}}$에 비례합니다. 정확도를 높이기 위해 다음 기법들이 사용됩니다.

| 기법 | 원리 | 효과 |
|---|---|---|
| 대칭 변량법 (Antithetic) | 양·음 대칭 경로 쌍 사용 | 분산을 약 50% 감소 |
| 통제 변량법 (Control Variate) | 닫힌 해가 있는 유사 상품과의 차이를 이용 | 상당한 분산 감소 |
| 중요도 샘플링 | OTM 옵션의 경우 ITM 영역에 더 많은 샘플 집중 | 깊은 OTM에서 효과적 |
| 층화 추출법 | 난수를 균등 구간으로 나누어 추출 | 균일한 커버리지 확보 |

:::tip 몬테카를로의 강점
몬테카를로 시뮬레이션은 경로의존형 옵션(아시안, 배리어, 룩백 등), 다변량 옵션(바스켓, 레인보우), 복잡한 페이오프 구조에 특히 강력합니다. BSM이나 이항 모델로 다루기 어려운 복잡한 구조도 시뮬레이션으로 가격결정이 가능합니다.
:::

## Black 모델 (선물옵션)

선물옵션의 가격결정에는 Black(1976) 모델이 사용됩니다. BSM 모델에서 기초자산 가격 대신 선물 가격을 사용하고, 캐리비용을 제거합니다.

$$C = e^{-rT}[F \cdot N(d_1) - K \cdot N(d_2)]$$

$$d_1 = \frac{\ln(F/K) + (\sigma^2/2)T}{\sigma\sqrt{T}}, \quad d_2 = d_1 - \sigma\sqrt{T}$$

여기서 $F$는 선물 가격입니다. 금리 상품(캡/플로어, 스왑션), 원자재 옵션의 가격결정에 광범위하게 사용됩니다.

## 로컬 변동성 모델 (Local Volatility)

### Dupire 모델

BSM의 상수 변동성 가정을 완화하여, 변동성이 기초자산 가격과 시간의 함수인 모델입니다.

$$dS = rS \, dt + \sigma(S, t) \cdot S \, dW$$

**Dupire 공식:** 시장에서 관측되는 모든 유럽형 옵션 가격과 일치하는 로컬 변동성 함수를 역산할 수 있습니다.

$$\sigma^2_{local}(K, T) = \frac{\frac{\partial C}{\partial T} + rK\frac{\partial C}{\partial K}}{\frac{1}{2}K^2\frac{\partial^2 C}{\partial K^2}}$$

- 시장의 변동성 표면과 완벽히 일관되는 가격을 생성
- 이색옵션의 가격결정에 기본 프레임워크로 활용
- 한계: 변동성 스마일의 동학(dynamics)을 정확히 포착하지 못함

## 확률적 변동성 모델 (Stochastic Volatility)

### 헤스톤 모델 (Heston Model)

헤스톤 모델은 변동성 자체가 확률 과정을 따르는 모델로, 가장 널리 사용되는 확률적 변동성 모델입니다.

$$dS = rS \, dt + \sqrt{v} \cdot S \, dW_1$$
$$dv = \kappa(\theta - v) \, dt + \xi\sqrt{v} \, dW_2$$
$$dW_1 \cdot dW_2 = \rho \, dt$$

- $v$: 순간 분산 (변동성의 제곱)
- $\kappa$: 평균회귀 속도
- $\theta$: 장기 평균 분산
- $\xi$: 변동성의 변동성 (Vol of Vol)
- $\rho$: 주가와 변동성 간 상관관계 (보통 음수: 주가 하락 시 변동성 상승)

**헤스톤 모델의 장점:**
- 변동성 스마일/스큐를 자연스럽게 생성
- 반닫힌 형(semi-closed form) 해가 존재하여 빠른 계산 가능 (특성함수 이용)
- 5개의 매개변수로 변동성 표면의 주요 특징을 포착

**매개변수의 역할:**

| 매개변수 | 영향 |
|---|---|
| $\kappa$ (평균회귀 속도) | 높을수록 변동성이 빠르게 장기 수준으로 복귀 |
| $\theta$ (장기 분산) | 변동성 기간 구조의 장기 수준 결정 |
| $\xi$ (Vol of Vol) | 높을수록 변동성 스마일의 곡률 증가 |
| $\rho$ (상관관계) | 음수일수록 변동성 스큐가 가파름 |
| $v_0$ (초기 분산) | 단기 옵션의 내재변동성 수준 결정 |

:::danger 모델 리스크 경고
어떤 가격결정 모델도 시장 현실을 완벽히 반영하지 못합니다. BSM은 변동성 스마일을 설명하지 못하고, 헤스톤은 단기 스마일을 과소 추정하는 경향이 있습니다. 실무에서는 여러 모델을 교차 검증하고, 모델 리스크를 인식하며 적절한 리저브를 설정하는 것이 필수적입니다.
:::

## 모델 비교 요약

| 모델 | 장점 | 단점 | 적용 대상 |
|---|---|---|---|
| BSM | 닫힌 해, 빠름, 직관적 | 상수 변동성 가정 비현실적 | 유럽형 바닐라 옵션 |
| CRR 이항 | 미국형 처리, 직관적 | 다차원 비효율, 배리어 수렴 느림 | 미국형 옵션, 배당 있는 옵션 |
| 몬테카를로 | 복잡한 구조 처리, 다차원 가능 | 느림, 미국형 처리 어려움 | 이색옵션, 다변량 옵션 |
| Black | 선물 기반, 간단 | BSM과 동일한 한계 | 선물옵션, 캡/플로어 |
| 로컬 변동성 | 시장 일관성 완벽 | 스마일 동학 부정확 | ELS 가격결정, 배리어옵션 |
| 헤스톤 | 스큐/스마일 포착, 빠름 | 단기 스마일 한계, 점프 없음 | 바닐라 + 이색옵션 |

## 한국 시장에서의 적용

한국 KOSPI200 옵션은 유럽형이므로 BSM 모델이 기본적으로 적용됩니다. 그러나 실무에서는 다음을 고려합니다.

- **배당 조정**: KOSPI200은 구성종목의 배당을 반영하여 Merton 모델 사용
- **변동성 표면**: KOSPI200 옵션의 변동성 스큐가 뚜렷하므로 로컬/확률적 변동성 모델 필요
- **ELS 가격결정**: 한국 특유의 스텝다운 ELS는 몬테카를로 시뮬레이션 + 로컬 변동성 모델 조합으로 가격결정
- **증권사 리스크 관리**: 대규모 ELS 발행에 따른 그릭스 관리에 정교한 모델 필수

---

## 참고 문헌

- Black & Scholes, "The Pricing of Options and Corporate Liabilities", *Journal of Political Economy*, 1973
- Cox, Ross & Rubinstein, "Option Pricing: A Simplified Approach", *Journal of Financial Economics*, 1979
- Heston, Steven, "A Closed-Form Solution for Options with Stochastic Volatility", *Review of Financial Studies*, 1993
- Hull, John C., *Options, Futures, and Other Derivatives*, Pearson, 11th ed., 2022

## 관련 페이지

- [옵션 기초](/assets/derivatives/options-basics) - 옵션 기본 개념
- [그릭스](/assets/derivatives/greeks) - BSM에서 유도되는 그릭스
- [변동성 분석](/assets/derivatives/volatility) - 변동성 표면과 모델링
- [이색옵션](/assets/derivatives/exotic-options) - 복잡한 구조의 가격결정
- [구조화 상품](/assets/derivatives/structured-products) - ELS 등 구조화상품의 가격결정
