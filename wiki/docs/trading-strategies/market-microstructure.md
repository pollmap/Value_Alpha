---
id: market-microstructure
title: 시장 미시구조와 수급 분석
sidebar_label: 시장 미시구조
description: 호가창 분석, 체결강도, 투자자별 수급 분석, 프로그램매매, 공매도 분석, 거래량 분석 등 한국 주식시장의 미시구조를 체계적으로 다룹니다.
keywords: [시장미시구조, 호가창, 체결강도, 수급분석, 프로그램매매, 공매도, 거래량, VWAP, 서킷브레이커, 외국인수급]
---

# 시장 미시구조와 수급 분석

## 1. 개요

시장 미시구조(Market Microstructure)는 증권 거래가 이루어지는 구체적인 메커니즘과 과정을 연구하는 분야입니다. 호가창의 구조, 체결 방식, 수급 주체별 행동 패턴 등을 이해하는 것은 실전 투자에서 매우 중요합니다.

본 문서에서는 한국 주식시장(KOSPI/KOSDAQ)의 미시구조를 중심으로 호가창 분석, 체결강도, 수급 분석, 프로그램매매, 공매도 분석, 거래량 분석 등을 다룹니다.

---

## 2. 호가창 분석 (Order Book Analysis)

### 2.1 호가창의 구조

호가창(Order Book)은 특정 시점에서 매수/매도 주문이 가격별로 정렬된 현황표입니다. 한국 주식시장에서는 최우선 매수/매도 호가를 포함하여 상하 10단계(총 20단계)의 호가 정보가 실시간으로 제공됩니다.

```
[매도 호가]           [매도 잔량]
52,500원              3,200주
52,400원              5,100주
52,300원              8,400주
52,200원              12,300주
52,100원              15,800주    ← 최우선 매도호가 (매도1)
─────────────────────────────────
52,000원              18,200주    ← 최우선 매수호가 (매수1)
51,900원              14,500주
51,800원              9,800주
51,700원              6,200주
51,600원              4,100주
[매수 호가]           [매수 잔량]
```

### 2.2 호가 스프레드 (Bid-Ask Spread)

호가 스프레드는 최우선 매도호가와 최우선 매수호가의 차이입니다. 이는 유동성의 대표적 지표이며, 스프레드가 좁을수록 유동성이 풍부한 것입니다.

$$
Spread = P_{ask} - P_{bid}
$$

$$
Spread(\%) = \frac{P_{ask} - P_{bid}}{(P_{ask} + P_{bid}) / 2} \times 100
$$

### 2.3 호가 단위

한국시장의 호가 단위는 주가 수준에 따라 다릅니다:

- **2,000원 미만**: 호가 단위 1원
- **2,000원 이상 ~ 5,000원 미만**: 호가 단위 5원
- **5,000원 이상 ~ 20,000원 미만**: 호가 단위 10원
- **20,000원 이상 ~ 50,000원 미만**: 호가 단위 50원
- **50,000원 이상 ~ 200,000원 미만**: 호가 단위 100원
- **200,000원 이상 ~ 500,000원 미만**: 호가 단위 500원
- **500,000원 이상**: 호가 단위 1,000원

호가 단위는 스프레드의 하한선을 결정하므로, 고가주일수록 상대적 스프레드가 넓어질 수 있습니다.

### 2.4 호가창 분석 지표

**호가잔량비율 (Order Imbalance):**

$$
OI = \frac{매수잔량 합계 - 매도잔량 합계}{매수잔량 합계 + 매도잔량 합계}
$$

OI가 양수이면 매수 압력이 우세하고, 음수이면 매도 압력이 우세한 것입니다. 다만 호가잔량은 허수 주문(spoofing)이 포함될 수 있으므로 주의가 필요합니다.

**호가 깊이 (Market Depth):**

특정 가격 범위 내의 총 주문량을 의미합니다. 깊이가 깊을수록 대량 주문이 시장가격에 미치는 충격이 작습니다.

$$
Depth_k = \sum_{i=1}^{k} Q_{bid,i} + \sum_{i=1}^{k} Q_{ask,i}
$$

여기서 $k$는 호가 단계 수, $Q$는 각 호가의 잔량입니다.

### 2.5 VWAP (Volume Weighted Average Price)

기관투자자들이 대량 주문 시 시장충격을 최소화하기 위해 사용하는 기준가격입니다.

$$
VWAP = \frac{\sum_{t=1}^{T} P_t \times V_t}{\sum_{t=1}^{T} V_t}
$$

VWAP 대비 체결가가 낮으면 매수 입장에서 유리한 체결이며, 높으면 불리한 체결입니다.

---

## 3. 체결강도 분석

### 3.1 체결강도란 무엇입니까?

체결강도는 일정 기간 동안의 매수 체결량과 매도 체결량의 비율을 나타내는 지표입니다. 실시간 수급의 방향성을 파악하는 데 유용합니다.

$$
체결강도 = \frac{매수\ 체결량}{매도\ 체결량} \times 100
$$

- 체결강도 > 100: 매수 우위 (주가 상승 압력)
- 체결강도 = 100: 매수/매도 균형
- 체결강도 < 100: 매도 우위 (주가 하락 압력)

### 3.2 체결 분류 방법

개별 체결 건이 매수인지 매도인지를 분류하는 방법은 다음과 같습니다:

**Lee-Ready 알고리즘:**

1. 체결가가 중간가(mid-price) 위이면 매수자 주도(buyer-initiated)로 분류합니다
2. 체결가가 중간가 아래이면 매도자 주도(seller-initiated)로 분류합니다
3. 체결가가 중간가와 같으면 Tick Test를 적용합니다 (직전 체결 대비 상승이면 매수, 하락이면 매도)

$$
MidPrice = \frac{P_{bid} + P_{ask}}{2}
$$

### 3.3 체결강도 활용법

체결강도는 단독으로 사용하기보다 다른 지표와 결합하여 활용하는 것이 효과적입니다.

- **주가 상승 + 체결강도 상승**: 강한 상승 추세를 의미합니다
- **주가 상승 + 체결강도 하락**: 상승 추세 약화 신호입니다
- **주가 하락 + 체결강도 상승**: 매수세 유입으로 반등 가능성이 있습니다
- **주가 하락 + 체결강도 하락**: 강한 하락 추세를 의미합니다

---

## 4. 수급 분석 (Flow Analysis)

### 4.1 투자자 유형별 특성

한국 주식시장의 투자자는 크게 외국인, 기관, 개인으로 구분됩니다. 각 투자자 유형은 고유한 행동 패턴을 보여줍니다.

#### 외국인 투자자

- **특징**: 장기 투자 성향, 대형주 선호, 환율 민감도 높음
- **데이터**: KRX에서 일별 순매수/순매도 데이터를 공시합니다
- **영향력**: KOSPI 시가총액의 약 30\~35%를 보유하고 있습니다
- **패턴**: 글로벌 매크로 환경(미국 금리, 달러 강세 등)에 민감하게 반응합니다

#### 기관투자자

기관투자자는 다시 세부적으로 구분됩니다:

- **금융투자 (증권사)**: 자기매매, 프롭 트레이딩, 단기 매매 성향
- **보험**: 장기 투자, 배당주 선호, 자산-부채 매칭
- **투신 (자산운용사)**: 펀드 설정/해지에 따른 수급, 벤치마크 추종
- **연기금**: 장기 투자, 밸류 중심, 시장 안정 역할
- **은행**: 제한적 참여, 채권 중심
- **사모펀드**: 다양한 전략, 이벤트 드리븐 다수

#### 개인투자자

- **특징**: 단기 매매 성향, 소형주/테마주 선호, 역추세(contrarian) 경향
- **데이터**: 외국인/기관의 반대편으로 추정 가능합니다
- **영향력**: 거래량 기준 약 60\~70%를 차지합니다
- **패턴**: 상승장에서 매도(차익 실현), 하락장에서 매수(물타기) 경향이 있습니다

### 4.2 수급 데이터 분석 방법

**순매수 추이 분석:**

$$
NetBuy_{t} = BuyVolume_{t} - SellVolume_{t}
$$

$$
CumulativeNetBuy = \sum_{i=1}^{T} NetBuy_{i}
$$

누적순매수 추이는 특정 투자자 유형의 중장기적 포지션 변화를 보여줍니다.

**수급 괴리 분석:**

외국인과 기관이 동시에 매수하고 개인이 매도하는 패턴은 역사적으로 주가 상승과 높은 상관관계를 보여왔습니다. 반대로 외국인과 기관이 동시에 매도하고 개인만 매수하는 패턴은 주의가 필요합니다.

### 4.3 수급 기반 투자 전략

1. **외국인 순매수 추종 전략**: 외국인이 20거래일 이상 연속 순매수하는 종목에 투자합니다
2. **기관 수급 반전 전략**: 기관 순매수 전환 시점을 포착하여 매수합니다
3. **개인 역발상 전략**: 개인 매수 상위 종목을 회피하거나 매도합니다

---

## 5. 프로그램매매 분석

### 5.1 프로그램매매란 무엇입니까?

프로그램매매는 컴퓨터 프로그램에 의해 자동으로 실행되는 대량 주문을 의미합니다. 한국시장에서 프로그램매매는 크게 **차익거래**와 **비차익거래**로 구분됩니다.

### 5.2 차익거래 (Arbitrage Trading)

KOSPI200 현물과 선물 간의 가격 차이(베이시스)를 이용하는 거래입니다.

**매수차익거래**: 선물 고평가 시 → 현물 매수 + 선물 매도
**매도차익거래**: 선물 저평가 시 → 현물 매도 + 선물 매수

$$
Basis = F_{0} - S_{0} \times e^{(r-d)T}
$$

여기서 $F_0$는 선물가격, $S_0$는 현물가격, $r$는 금리, $d$는 배당수익률, $T$는 만기까지 기간입니다.

이론 베이시스 대비 실제 베이시스가 크면 차익거래 기회가 발생합니다.

### 5.3 비차익거래

차익거래 이외의 프로그램매매로, 바스켓 주문, 인덱스 리밸런싱, 알고리즘 트레이딩 등이 포함됩니다. 비차익거래는 실제 투자 의도를 반영하므로 수급 분석에서 더 중요한 의미를 가집니다.

### 5.4 프로그램매매 데이터 해석

- **차익 매수잔고 증가**: 향후 만기 시 매도 물량 증가 예상
- **비차익 매수 지속**: 기관의 실질적 매수 수요 존재
- **프로그램 매도 폭발**: 일시적 수급 충격으로 저점 매수 기회 가능
- **만기일(선물/옵션)**: 차익거래 청산에 따른 변동성 확대

---

## 6. 공매도 분석

### 6.1 공매도 데이터

한국시장에서 공매도 관련 데이터는 다음과 같이 제공됩니다:

- **일별 공매도 거래량**: KRX에서 종목별로 공시합니다
- **공매도 잔고**: 주 1회(매주 수요일 기준) 공시합니다
- **대차거래 잔고**: 일별로 공시됩니다

### 6.2 공매도 분석 지표

**공매도 비율:**

$$
공매도\ 비율 = \frac{공매도\ 거래량}{총\ 거래량} \times 100
$$

**공매도 잔고 비율:**

$$
공매도\ 잔고\ 비율 = \frac{공매도\ 잔고}{상장주식수} \times 100
$$

**대차잔고 비율:**

$$
대차잔고\ 비율 = \frac{대차잔고\ 주식수}{상장주식수} \times 100
$$

### 6.3 공매도 분석 전략

1. **공매도 잔고 감소 전략**: 공매도 잔고가 고점에서 감소 전환할 때 매수합니다
2. **높은 공매도 회피 전략**: 공매도 비율이 급증하는 종목을 회피합니다
3. **공매도 스퀴즈 전략**: 공매도 잔고가 높고 촉매 이벤트가 예상되는 종목을 선별합니다

### 6.4 한국시장 공매도 규제

한국시장의 공매도 규제는 다음과 같은 특징이 있습니다:

- 업틱 룰(Uptick Rule) 적용: 직전 체결가 이하로 공매도 불가
- 무차입 공매도 금지
- 공매도 과열 종목 지정제도: 과열 기준 충족 시 다음날 공매도 금지
- 특정 시기 전면 금지 조치 시행 가능

---

## 7. 거래량 분석

### 7.1 거래량의 중요성

거래량은 가격 변동의 확인 지표(confirmation indicator)로서 매우 중요합니다. "거래량은 주가에 선행한다"는 격언이 있을 정도로, 거래량 변화는 향후 주가 방향에 대한 중요한 단서를 제공합니다.

### 7.2 주요 거래량 지표

**거래대금회전율:**

$$
거래대금회전율 = \frac{일간\ 거래대금}{시가총액} \times 100
$$

**OBV (On Balance Volume):**

$$
OBV_t = OBV_{t-1} + \begin{cases} V_t & \text{if } P_t > P_{t-1} \\ -V_t & \text{if } P_t < P_{t-1} \\ 0 & \text{if } P_t = P_{t-1} \end{cases}
$$

OBV의 추세가 주가 추세와 일치하면 추세 지속을 확인할 수 있고, 괴리가 발생하면 추세 전환 신호입니다.

**거래량 이동평균 비율:**

$$
VolumeRatio = \frac{V_t}{MA(V, n)}
$$

이 비율이 2배 이상이면 이상 거래량으로 판단하며, 특별한 수급 변화가 발생하고 있음을 시사합니다.

### 7.3 거래량 패턴 분석

- **상승 확인**: 주가 상승, 거래량 증가. 건전한 상승 추세입니다
- **상승 의심**: 주가 상승, 거래량 감소. 상승 추세 약화 가능성이 있습니다
- **하락 확인**: 주가 하락, 거래량 증가. 강한 매도 압력이 존재합니다
- **하락 둔화**: 주가 하락, 거래량 감소. 매도 소진으로 반등 가능성이 있습니다
- **바닥 신호**: 주가 횡보, 거래량 극소량. 매도 세력 소진, 반등 임박 가능합니다
- **천정 신호**: 주가 횡보, 거래량 급증. 대량 물량 교체, 고점 가능성이 있습니다

### 7.4 거래량 급증 분석

거래량이 평균 대비 3\~5배 이상 급증하는 경우, 이는 중요한 수급 변화 신호입니다. 다음 사항을 함께 확인해야 합니다:

1. 공시 또는 뉴스가 있는지 확인합니다
2. 투자자 유형별 순매수 내역을 확인합니다
3. 프로그램매매 영향을 확인합니다
4. 블록딜(대량매매) 여부를 확인합니다

---

## 8. KOSPI/KOSDAQ 시장구조

### 8.1 시장 개요

- **KOSPI**: 유가증권시장 (대형주 중심). 상장 기업 수 약 800\~900개. 시가총액 약 2,000조원 이상. 대표 지수 KOSPI, KOSPI200. 외국인 비중 약 30\~35%. 가격제한폭 ±30%
- **KOSDAQ**: 코스닥시장 (중소형/벤처 중심). 상장 기업 수 약 1,600\~1,700개. 시가총액 약 400조원 이상. 대표 지수 코스닥지수, 코스닥150. 외국인 비중 약 8\~12%. 가격제한폭 ±30%

### 8.2 매매 시간

한국 주식시장의 매매 시간은 다음과 같습니다:

```
08:00\~08:30    장 전 동시호가 (주문 접수)
08:30\~09:00    장 전 동시호가 (주문 접수, 08:30부터 예상체결가 공개)
09:00          장 개시 (동시호가 체결)
09:00\~15:20    정규 매매 시간 (접속매매)
15:20\~15:30    장 마감 동시호가
15:30          장 마감 (동시호가 체결)
15:40\~16:00    시간외 종가매매
16:00\~18:00    시간외 단일가매매
```

### 8.3 주문 유형

한국시장에서 사용 가능한 주문 유형은 다음과 같습니다:

- **지정가 주문**: 특정 가격을 지정하여 주문합니다
- **시장가 주문**: 가격을 지정하지 않고 최우선 호가로 체결됩니다
- **조건부 지정가**: 장중에는 지정가, 종가 동시호가 시 시장가로 전환됩니다
- **최유리 지정가**: 주문 시점의 최우선 호가로 지정가 전환됩니다
- **최우선 지정가**: 주문 시점의 최우선 호가에 1틱 우선한 가격으로 전환됩니다
- **IOC (즉시체결/취소)**: 즉시 체결 가능한 수량만 체결하고 나머지는 취소됩니다
- **FOK (전량체결/취소)**: 전량 즉시 체결이 안 되면 전량 취소됩니다

### 8.4 가격제한 및 서킷브레이커

**가격제한폭**: KOSPI와 KOSDAQ 모두 전일 종가 대비 ±30%입니다.

**서킷브레이커(Circuit Breaker):**

- **1단계**: 발동 조건 -- KOSPI가 전일 대비 8% 이상 하락하고 1분간 지속. 효과 -- 20분간 매매 중단
- **2단계**: 발동 조건 -- 1단계 발동 후 KOSPI가 추가 하락하여 15% 이상 하락. 효과 -- 20분간 매매 중단
- **3단계**: 발동 조건 -- 2단계 발동 후 KOSPI가 추가 하락하여 20% 이상 하락. 효과 -- 당일 매매 종료

**사이드카(Sidecar):**

선물가격이 전일 대비 5% 이상 변동 시 프로그램매매 호가 효력을 5분간 정지합니다.

### 8.5 공시 제도

한국시장의 공시 제도는 투자 판단에 필수적인 정보를 제공합니다:

- **수시공시**: 기업의 중요 경영사항 발생 시 즉시 공시합니다 (M&A, 유상증자, 자사주매입 등)
- **정기공시**: 분기/반기/연간 재무제표를 정해진 기한 내에 공시합니다
- **공정공시**: 애널리스트 등 특정인에게 제공한 정보를 동시에 공시합니다
- **지분공시**: 5% 이상 대량보유 시 보유 현황을 공시합니다 (5% 룰)

### 8.6 ETF와 시장구조

ETF(상장지수펀드)의 성장은 시장 미시구조에 상당한 영향을 미치고 있습니다.

- **유동성 집중**: ETF 구성 종목의 유동성이 증가하는 반면, 미편입 종목의 유동성은 감소합니다
- **종가 거래량 증가**: ETF 리밸런싱으로 인해 장 마감 동시호가의 거래 비중이 증가하고 있습니다
- **상관관계 증가**: 같은 ETF에 편입된 종목 간 동조화 현상이 강화되고 있습니다
- **인버스/레버리지 ETF**: 만기일 변동성에 영향을 미칩니다

---

## 9. 실전 수급 분석 프레임워크

### 9.1 종합 수급 점수표

실전에서 수급을 종합적으로 평가하기 위한 프레임워크는 다음과 같습니다:

- **외국인 수급** (가중치 30%): 긍정 신호 -- 5일 이상 연속 순매수. 부정 신호 -- 5일 이상 연속 순매도
- **기관 수급** (가중치 25%): 긍정 신호 -- 투신/연기금 순매수. 부정 신호 -- 투신/연기금 순매도
- **거래량 추세** (가중치 20%): 긍정 신호 -- 상승 시 거래량 증가. 부정 신호 -- 상승 시 거래량 감소
- **프로그램 수급** (가중치 15%): 긍정 신호 -- 비차익 매수 유입. 부정 신호 -- 차익 매도 잔고 증가
- **공매도 추이** (가중치 10%): 긍정 신호 -- 공매도 잔고 감소. 부정 신호 -- 공매도 잔고 급증

### 9.2 수급 분석 체크리스트

실전 투자에서 수급을 분석할 때 다음 체크리스트를 순서대로 확인하는 것을 권장합니다:

1. **거시 수급 확인**: 외국인/기관의 시장 전체 순매수 추이를 확인합니다
2. **섹터 수급 확인**: 해당 종목이 속한 섹터의 수급 흐름을 확인합니다
3. **종목별 수급 확인**: 투자자 유형별 순매수 추이를 일별/주별로 확인합니다
4. **거래량 이상 여부**: 평균 거래량 대비 이상 거래량이 발생하는지 확인합니다
5. **프로그램매매 영향**: 프로그램 매수/매도가 수급에 미치는 영향을 분석합니다
6. **공매도 변화**: 공매도 잔고 증감 추이를 확인합니다
7. **호가창 분석**: 실시간 호가잔량의 비대칭성을 확인합니다

---

## 10. 시장 미시구조의 최근 변화

### 10.1 알고리즘 트레이딩의 확대

한국시장에서도 알고리즘 트레이딩의 비중이 꾸준히 증가하고 있습니다. 주요 특징은 다음과 같습니다:

- TWAP, VWAP 등 실행 알고리즘이 기관 거래에서 보편화되었습니다
- 고빈도 매매(HFT)의 비중도 점진적으로 증가하고 있습니다
- 코로케이션(co-location) 서비스가 KRX에서 제공되고 있습니다

### 10.2 개인투자자 행태 변화

2020년 이후 개인투자자의 시장 참여가 크게 증가하였으며, 투자 행태에도 변화가 관찰됩니다:

- 해외주식 직접투자 증가로 국내시장 자금 이탈이 발생하고 있습니다
- ETF 투자 비중이 개인투자자 사이에서도 증가하고 있습니다
- 주식 커뮤니티/SNS를 통한 정보 전파 속도가 빨라졌습니다

### 10.3 T+1 결제 제도

현재 한국시장은 T+2 결제 제도를 운영하고 있습니다. 향후 T+1 결제로 전환이 논의되고 있으며, 이는 시장 미시구조에 상당한 변화를 가져올 수 있습니다.

---

## 11. 요약

시장 미시구조와 수급 분석은 투자 타이밍과 실행 효율성을 높이는 데 필수적인 분야입니다. 핵심 사항을 정리하면 다음과 같습니다.

1. **호가창 분석**: 실시간 수급의 미시적 변화를 파악하는 데 유용하나, 허수 주문에 주의해야 합니다
2. **체결강도**: 주가 방향과 결합하여 추세의 강도를 확인하는 보조 지표로 활용합니다
3. **투자자별 수급**: 외국인과 기관의 수급 방향이 주가 추세와 높은 상관관계를 보입니다
4. **프로그램매매**: 차익/비차익 구분이 중요하며, 비차익 매매가 실질적 수급 신호입니다
5. **공매도**: 공매도 잔고의 변화는 향후 환매수 수요를 예측하는 데 활용됩니다
6. **거래량**: 가격 변동의 확인 지표로서, 거래량이 수반되지 않는 주가 변동은 신뢰도가 낮습니다
7. **시장구조 이해**: KOSPI/KOSDAQ의 매매 제도, 호가 단위, 가격제한 등 기본 구조를 정확히 이해해야 합니다

시장 미시구조에 대한 이해는 모든 투자 전략의 실행 효율성을 높이는 기반입니다. 아무리 좋은 전략이라도 실행이 부실하면 이론적 성과를 달성할 수 없으므로, 미시구조에 대한 학습을 지속하는 것이 중요합니다.

:::tip 실전 적용 팁
수급 분석은 단일 지표에 의존하지 말고 복수의 지표를 종합적으로 판단해야 합니다. 외국인/기관 수급, 거래량 추이, 프로그램매매, 공매도 변화를 함께 확인하는 습관을 들이면 투자 타이밍의 정확도를 높일 수 있습니다.
:::

:::info 관련 페이지
- [매매 전략 개요](./overview) - 전략 분류와 기초
- [스윙 트레이딩](./swing-trading) - 단기 매매에서의 수급 활용
- [이벤트 드리븐 전략](./event-driven) - 이벤트 기반 수급 분석
- [퀀트 전략](./quant) - 체계적 데이터 기반 투자
:::
